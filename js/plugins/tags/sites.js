"use strict";function _createForOfIteratorHelper(r,t){var e="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=_unsupportedIterableToArray(r))||t&&r&&"number"==typeof r.length){e&&(r=e);var n=0,a=function(){};return{s:a,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(r){throw r},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){e=e.call(r)},n:function(){var r=e.next();return i=r.done,r},e:function(r){l=!0,o=r},f:function(){try{i||null==e["return"]||e["return"]()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(r,t){if(r){if("string"==typeof r)return _arrayLikeToArray(r,t);var e={}.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(r,t):void 0}}function _arrayLikeToArray(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=Array(t);e<t;e++)n[e]=r[e];return n}var SitesJS={requestAPI:function(r,t,e){var n=5;!function a(){return new Promise(function(o,i){var l=0,c=setTimeout(function(){0===l&&(l=2,c=null,i("请求超时"),0==n&&e())},5e3);fetch(r).then(function(r){if(2!==l&&(clearTimeout(c),o(r),c=null,l=1),r.ok)return r.json();throw new Error("Network response was not ok.")}).then(function(r){n=0,t(r)})["catch"](function(r){n>0?(n-=1,setTimeout(function(){a()},5e3)):e()})})}()},layout:function(r){var t=r.el;SitesJS.requestAPI(r.api,function(e){t.querySelector(".loading-wrap").remove();var n=e.content,a="";n.forEach(function(t,e){var n='<div class="site-card">';n+='<a class="card-link" target="_blank" rel="external noopener noreferrer" href="'+t.url+'">',n+='<img alt="'+t.title+'" src="'+(t.cover||t.snapshot||t.screenshot||"https://image.thum.io/get/width/1024/crop/768/"+t.url)+'" onerror="errorImgCover(this)"/>',n+='<div class="info">',n+='<img alt="'+t.title+'" src="'+(t.icon||t.avatar||r.avatar)+'" onerror="errorImgAvatar(this)"/>',n+='<span class="title">'+t.title+"</span>",n+='<span class="desc">'+(t.description||t.url)+"</span>",n+="</div>",n+='<div class="labels">';var o,i=_createForOfIteratorHelper(t.labels);try{for(i.s();!(o=i.n()).done;){var l=o.value;l.lightness>75?n+='<div class="label" style="background:#'.concat(l.color,";color:hsla(").concat(l.hue,", ").concat(l.saturation,'%, 20%, 1);">').concat(l.name,"</div>"):l.saturation>90&&l.lightness>40?n+='<div class="label" style="background:#'.concat(l.color,";color:hsla(").concat(l.hue,', 50%, 20%, 1);">').concat(l.name,"</div>"):n+='<div class="label" style="background:#'.concat(l.color,';color:white">').concat(l.name,"</div>")}}catch(c){i.e(c)}finally{i.f()}n+="</div>",n+="</a>",a+=n+="</div>"}),t.querySelector(".group-body").innerHTML=a},function(){try{t.querySelector(".loading-wrap svg").remove(),t.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(r){}})},start:function(r){for(var t=document.getElementsByClassName("sitesjs-wrap"),e=0;e<t.length;e++){var n=t[e],a=n.getAttribute("api");if(null!=a)(r=new Object)["class"]=n.getAttribute("class"),r.el=n,r.api=a,r.avatar=volantis.GLOBAL_CONFIG["default"].link,r.screenshot=volantis.GLOBAL_CONFIG["default"].cover,SitesJS.layout(r)}}};SitesJS.start();
//# sourceMappingURL=../../../maps/js/plugins/tags/sites.js.map
