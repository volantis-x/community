"use strict";function _createForOfIteratorHelper(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=_unsupportedIterableToArray(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==e["return"]||e["return"]()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,a=Array(r);e<r;e++)a[e]=t[e];return a}var FpostsJS={requestAPI:function(t,r,e){var a=5;!function n(){return new Promise(function(o,c){var l=0,s=setTimeout(function(){0===l&&(l=2,s=null,c("请求超时"),0==a&&e())},5e3);fetch(t).then(function(t){if(2!==l&&(clearTimeout(s),o(t),s=null,l=1),t.ok)return t.json();throw new Error("Network response was not ok.")}).then(function(t){a=0,r(t)})["catch"](function(t){a>0?(a-=1,setTimeout(function(){n()},5e3)):e()})})}()},layout:function(t){var r=t.el,e=t.avatar;FpostsJS.requestAPI(t.api,function(t){r.querySelector(".loading-wrap").remove();var a=t.content,n="";a.forEach(function(t,r){var a,o='<div class="grid-cell user-post-card">';o+='<div class="avatar-box">',o+='<a class="card-link" target="_blank" rel="external nofollow noopener noreferrer" href="'.concat(t.html_url||t.url,'">'),o+='<img src="'.concat(t.avatar_url||t.avatar||t.icon||e,"\" onerror=\"javascript:this.removeAttribute('data-src');this.src='").concat(e,"';\"/>"),o+='<span class="title">'.concat(t.title||t.login,"</span>"),o+="</a>",o+='<div class="labels">';var c,l=_createForOfIteratorHelper(t.labels);try{for(l.s();!(c=l.n()).done;){var s=c.value;s.lightness>75?o+='<div class="label" style="background:#'.concat(s.color,";color:hsla(").concat(s.hue,", ").concat(s.saturation,'%, 20%, 1);">').concat(s.name,"</div>"):s.saturation>90&&s.lightness>40?o+='<div class="label" style="background:#'.concat(s.color,";color:hsla(").concat(s.hue,', 50%, 20%, 1);">').concat(s.name,"</div>"):o+='<div class="label" style="background:#'.concat(s.color,';color:white">').concat(s.name,"</div>")}}catch(d){l.e(d)}finally{l.f()}if(o+="</div>",o+="</div>",o+='<div class="previews">',t.description?o+='<div class="desc">'.concat(t.description||t.issue_number||"","</div>"):o+='<div class="desc">#'.concat(t.issue_number,"</div>"),o+='<div class="posts">',(null===(a=t.posts)||void 0===a?void 0:a.length)>0){var i,u=_createForOfIteratorHelper(t.posts);try{for(u.s();!(i=u.n()).done;){var v=i.value;o+='<a class="post-link" target="_blank" rel="external nofollow noopener noreferrer" href="'.concat(v.link,'">'),o+='<span class="title">'.concat(v.title,"</span>"),o+='<span class="date">'.concat(v.published,"</span>"),o+="</a>"}}catch(d){u.e(d)}finally{u.f()}}else{var f;o+='<span class="no-post">'.concat((null===(f=t.feed)||void 0===f?void 0:f.length)>0?"RSS 解析失败":"未设置 RSS 链接","</span>")}o+="</div>",o+="</div>",n+=o+="</div>"}),r.querySelector(".grid-box").innerHTML=n},function(){try{r.querySelector(".loading-wrap svg").remove(),r.querySelector(".loading-wrap p").innerText("加载失败，请稍后重试。")}catch(t){}})},start:function(){for(var t=document.getElementsByClassName("users-posts-wrap"),r=0;r<t.length;r++){var e=t[r],a=e.getAttribute("api");if(null!=a){var n=new Object;n.el=e,n.api=a,n["class"]=e.getAttribute("class"),n.avatar=volantis.GLOBAL_CONFIG["default"].avatar,FpostsJS.layout(n)}}}};FpostsJS.start();
//# sourceMappingURL=../../../maps/js/plugins/tags/fposts.js.map
